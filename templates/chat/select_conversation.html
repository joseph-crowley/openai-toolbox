{% extends 'base.html' %}
{% block title %}Load Conversation{% endblock %}
{% block content %}
<div class="center-content">
    <section class="conversation-selection">
        {% if error_message %}
            <p class="error">{{ error_message }}</p>
        {% endif %}
        <form method="post" action="{% url 'select_conversation' %}">
            {% csrf_token %}
            <div class="conversation-selection">
                <h2>Select a Conversation</h2>
                {% for conversation_file in conversation_files reversed %}
                    <div class="conversation-card" onclick="selectConversation(this, '{{ conversation_file }}')">
                        {{ conversation_file|cut:".json" }}
                    </div>
                {% endfor %}
                <h2>Saved Conversations</h2>
                {% for saved_conversation in saved_conversations reversed %}
                    <div class="conversation-card" onclick="selectConversation(this, '{{ saved_conversation }}')">
                        {{ saved_conversation|cut:"_saved.json" }}
                    </div>
                {% endfor %}
                <input type="hidden" id="selected_conversation_file" name="conversation_file">
            </div>
            {% if error_message %}
                <div class="alert alert-danger" role="alert">
                    {{ error_message }}
                </div>
            {% endif %}
            <div class="text-center">
                <button type="submit" class="load-conversation-btn">Load Conversation</button>
            </div>
        </form>
    </section>

<script>
    let selectedCard = null;

    function selectConversation(conversationCard, conversation_file) {
        if (selectedCard) {
            selectedCard.classList.remove('selected');
        }

        conversationCard.classList.add('selected');
        selectedCard = conversationCard;

        document.getElementById("selected_conversation_file").value = conversation_file;
    }
</script>
{% endblock %}

