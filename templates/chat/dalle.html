<!--
DOCUMENTATION GENERATED BY AI

DALL-E Image Generator

The main purpose of this code is to provide a web interface for generating images using an
implementation of the DALL-E AI model. Users can enter a prompt, and the generated image
will be displayed on the page. The code is part of a Django web app, and it extends the
'base.html' template.

Related Files and Dependencies:
- base.html: The base template which this code extends.
- static: Static files, such as images, CSS, or JavaScript, are stored here.

Key Implementation Details:

1. HTML Structure:
   The content block consists of the following elements:
   - A main container div with the class "dalle-container"
   - An h1 element with the class "dalle-title" for displaying the title
   - A paragraph for providing instructions
   - A form element for the input field and submit button
   - A div element with the id "image-container" where the generated image and prompt will be displayed

2. JavaScript Code:
   The JavaScript code handles form submission, making an AJAX request to the '/dalle/' endpoint
   with the user's input as a query parameter. It parses the JSON response, creates an image
   element, and appends it to the "image-container" element along with the prompt.

Additional Information:

- The Django tags {% load static %} and {% static '' %} are used to load and refer to
  static files in the project.
- The code uses the Fetch API to make an asynchronous request to the server.
- The script handles error messages returned by the server and displays them as alerts.

Maintaining the Code:

When updating the code, ensure that the dependencies and related files are updated accordingly.
Take special care when modifying the structure of the HTML elements, as JavaScript code relies
on specific element ids and classes. Changes to the Django template tags and the API endpoint
may also require updates to related Django files, such as views and URL configurations.


Copyright 2023, Joe Crowley, All rights reserved.
-->
{% extends 'base.html' %}

{% load static %}
{% block title %}DALL-E{% endblock %}

{% block content %}
    <div class="dalle-container">
        <h1 class="dalle-title">DALL-E Image Generator</h1>
        <p>Enter a prompt to generate an image using DALL-E:</p>

        <form id="dalle-form">
            <input type="text" id="prompt" name="prompt" placeholder="Enter your prompt" required>
            <button type="submit">Generate Image</button>
        </form>

        <div id="image-container">
            <!-- Image and prompt will be displayed here -->
        </div>
    </div>

    <script>
        const form = document.getElementById("dalle-form");
        const imageContainer = document.getElementById("image-container");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const prompt = document.getElementById("prompt").value;
            if (!prompt) return;

            try {
                const response = await fetch(`/dalle/?prompt=${encodeURIComponent(prompt)}`, {
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                const data = await response.json();

                if (data.error) {
                    alert(`Error: ${data.error}`);
                } else {
                    const img = document.createElement("img");
                    img.src = `{% static '' %}` + data.image_path;
                    img.alt = prompt;
                    img.style.maxWidth = "100%";

                    const promptDisplay = document.createElement("p");
                    promptDisplay.innerText = `Prompt: ${prompt}`;

                    imageContainer.innerHTML = "";
                    imageContainer.appendChild(img);
                    imageContainer.appendChild(promptDisplay);
                }
            } catch (err) {
                alert(`Error: ${err.message}`);
            }
        });
    </script>
{% endblock %}
